{ @ (0:critical_section,1:critical_section) false }

flag_0 = 0, flag_1 = 0, turn = 0

#

flag_0 := 1
turn := 1
mfence

f := flag_1
t := turn
while (f = 1 && t = 1) {
    f := flag_1
    t := turn
}

label critical_section

flag_0 := 0
mfence

#
flag_1 := 1
turn := 0
mfence

f := flag_0
t := turn
while (f = 1 && t = 0) {
    f := flag_0
    t := turn
}

label critical_section

flag_1 := 0
mfence
